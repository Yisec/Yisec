{"version":3,"file":"yisec.js","sources":["../lib/register.js","../lib/util.js","../lib/Component.js","../lib/FVEvents.js","../lib/d.js","../lib/ast.js","../lib/forceUpdate.js","../lib/autorun.js","../lib/parser/parseExpr.js","../lib/execExpr.js","../lib/diff.js","../lib/handleClass.js","../lib/eventAlias.js","../lib/domLifeCycle.js","../lib/unmount.js","../lib/handleStyle.js","../lib/transform.js","../lib/render.js","../lib/index.js"],"sourcesContent":["/**\n * 所有注册组件缓存\n */\nexport const registerComponents = {};\n/**\n * 添加全局组件\n * @param name\n * @param Com\n */\nexport default function register(name, Com) {\n    registerComponents[name] = Com;\n}\n","import { registerComponents } from \"./register\";\nimport Component from \"./Component\";\n/**\n * 获取数据类型\n * @param arg\n */\nexport function getType(arg) {\n    return Object.prototype.toString.call(arg).match(/\\s(.+)]/)[1].toLowerCase();\n}\nexport function isFunction(...args) {\n    return args.every(arg => getType(arg) === 'function');\n}\nexport function isArray(...args) {\n    return args.every(arg => getType(arg) === 'array');\n}\nexport function isObject(...args) {\n    return args.every(arg => getType(arg) === 'object');\n}\nexport function isString(...args) {\n    return args.every(arg => getType(arg) === 'string');\n}\nexport function isBool(...args) {\n    return args.every(arg => getType(arg) === 'boolean');\n}\nexport function isPromise(...args) {\n    return args.every(arg => getType(arg) === 'promise');\n}\n/**\n * 转classname\n * @param v\n */\nexport function toClassNames(v) {\n    switch (getType(v)) {\n        case 'array': {\n            return v.map(toClassNames).join(' ');\n        }\n        case 'object': {\n            return Object.keys(v).map(key => {\n                return v[key] ? key : '';\n            }).join(' ');\n        }\n        case 'string': {\n            return v;\n        }\n        default: {\n            return '';\n        }\n    }\n}\n// setTimeout的封装\nexport function ST(fn, time) {\n    if (time > 0) {\n        setTimeout(fn, time);\n    }\n    else {\n        fn();\n    }\n}\n// 移除重复元素\nexport function uniqueArr(arr = []) {\n    const newArr = [];\n    arr.forEach(item => {\n        if (!newArr.includes(item)) {\n            newArr.push(item);\n        }\n    });\n    return newArr;\n}\nexport function merge(...anys) {\n    const base = anys[0];\n    anys.slice(1).forEach(any => {\n        Object.keys(any).forEach(key => {\n            base[key] = any[key];\n        });\n    });\n    return base;\n}\n/**\n * 绑定this\n * @param fn\n * @param ctx\n */\nexport function bindContext(fn, ctx) {\n    if (getType(fn).includes('function')) {\n        fn = fn.bind(ctx);\n    }\n    return fn;\n}\nexport function uuid(len = 8) {\n    const S = '0123456789qwertyuioopasdfghjklzxcvbnmQWERTYUIOOPASDFGHJKLZXCVBNM';\n    const LEN = S.length;\n    return ' '.repeat(len).split('').map(() => S[Math.round(Math.random() * LEN)]).join('');\n}\nexport function getComponent(name = '', ctxs = []) {\n    for (let i = 0; i < ctxs.length; i++) {\n        if (ctxs[i].components && ctxs[i].components[name]) {\n            return ctxs[i].components[name];\n        }\n    }\n    return registerComponents[name];\n}\nexport function getParentCtx(ctxs = []) {\n    for (let i = 0; i < ctxs.length; i++) {\n        if (ctxs[i] instanceof Component) {\n            return ctxs[i];\n        }\n    }\n}\n","import { isFunction } from \"./util\";\nexport default class Component {\n    constructor() {\n        // 模板\n        this.template = '';\n        // 状态\n        this.state = {};\n        // props\n        this.props = {};\n        // 子组件\n        this.components = {};\n        // 子组件\n        this.children = [];\n        // 指定dom\n        this.refs = {};\n        // 方便template直接获取经过复杂计算的数据\n        this.computed = {};\n        // 触发props上的事件\n        this.$emit = (key, ...data) => {\n            let parent = this.parent;\n            let stopBubble = false;\n            while (!stopBubble && parent) {\n                const fn = parent.emit[key] || parent[key];\n                if (isFunction(fn)) {\n                    stopBubble = fn.call(parent, ...data) === false;\n                }\n                parent = parent.parent;\n            }\n        };\n        this.$emitChildren = (key, ...data) => {\n            function children(node) {\n                node.children.forEach(item => {\n                    const fn = item.emit[key] || item[key];\n                    isFunction(fn) && fn.call(item, ...data);\n                    children(item);\n                });\n            }\n            children(this);\n        };\n        this.$emitSiblings = (key, ...data) => {\n            this.parent && this.parent.children.forEach(item => {\n                if (item !== this) {\n                    const fn = item.emit[key] || item[key];\n                    isFunction(fn) && fn.call(item, ...data);\n                }\n            });\n        };\n        this.emit = {};\n    }\n    render() {\n        return this.template;\n    }\n    willMount() { }\n    didMount() { }\n    didUpdate() { }\n    // 内部方法，触发组件卸载\n    __willUnmount() {\n        this.children.forEach(com => com.__willUnmount());\n        this.willUnmount();\n        this.children = [];\n        if (this.parent) {\n            this.parent.children = this.parent.children.filter(i => i !== this);\n        }\n    }\n    willUnmount() { }\n}\nComponent.defaultProps = {};\n","/**\n * FVEvents 被用来统一处理事件监听\n */\nexport default class FVEvents {\n    constructor() {\n        this.cache = [];\n    }\n    /**\n     * 事件绑定\n     */\n    on(element, key, fn) {\n        this.cache.push([key, fn]);\n        element.addEventListener(key, fn);\n        return this;\n    }\n    /**\n     * 事件移除\n     */\n    off(element, key, fn) {\n        this.cache = this.cache.filter(([_key, _fn]) => {\n            if ((key === _key && fn === _fn) // 卸载指定key,fn的事件\n                || (key === _key && fn === undefined) // 卸载指定key的事件\n                || (key === undefined && fn === undefined) // 卸载所有事件\n            ) {\n                element.removeEventListener(_key, _fn);\n                return false;\n            }\n        });\n        return this;\n    }\n}\n","import FVEvents from \"./FVEvents\";\nexport class VirtualDOM {\n    constructor(parent) {\n        this.exprs = [];\n        this.events = new FVEvents();\n        this.children = [];\n        this.ctxs = [];\n        this.unmounted = false;\n        if (parent) {\n            this.parent = parent;\n            this.parent.children.push(this);\n        }\n    }\n    unmount() {\n        this.exprs.forEach(fn => fn());\n        (this.dom instanceof HTMLElement) && this.events.off(this.dom);\n        this.component && this.component.__willUnmount();\n        this.unmounted = true;\n    }\n}\nexport class TokenElement {\n    constructor(type, index, value, origin = value) {\n        this.type = type;\n        this.index = index;\n        this.value = value;\n        this.origin = origin;\n    }\n}\n/**\n * AST节点\n * @class ASTNode\n */\nexport class ASTNode {\n    constructor(tagName = '') {\n        this.children = []; // 子节点\n        this.props = {}; // props\n        this.type = 'element'; // 节点类型\n        this.exprs = [];\n        this.tagName = tagName;\n        // 判断是不是组件\n        if (/^[A-Z]/.test(tagName)) {\n            this.type = 'component';\n        }\n    }\n}\n","// 解析template\n// 有时候我们不想使用jsx，不想使用babel编译💊\n// 那就使用类似vue angular之类的字符串模板吧\n// 使用模板编译的好处有哪些？，模板本身可以作为资源加载，也就是View层 \n// 自身的逻辑层可以作为控制器\n// 再加一个Model作为数据来源\nimport { ASTNode, TokenElement } from \"./d\";\n/**\n * 半闭合标签 可以以 > 或 /> 结尾\n */\nconst selfCloseElements = ['img', 'br', 'hr', 'input'];\n// 我们应该在解析关键字的同时，保留原始字符串\nconst M = {\n    get SELF_CLOSE() {\n        return /^(\\/\\s*>)\\s*/;\n    },\n    get CLOSE_START() {\n        return /^(<\\s*\\/)\\s*/;\n    },\n    get TAG_CLOSE() {\n        return /^(>)\\s*/;\n    },\n    get OPEN_START() {\n        return /^(<)\\s*/;\n    },\n    get EQ() {\n        return /^(=)\\s*/;\n    },\n    get TAG_NAME() {\n        return /^([a-zA-Z]-?([a-zA-Z0-9]-?)*)\\s*/;\n    },\n    get PROPERTY_NAME() {\n        return /^([a-zA-Z@:]-?([a-zA-Z0-9]-?)*)\\s*/;\n    },\n    get PROPERTY_VALUE() {\n        return /^\"([^\"]*)\"\\s*/;\n    },\n    get EXPR() {\n        return /^{{2}(((?!}{2}).)*)\\}{2}\\s*/;\n    },\n    get STRING() {\n        return /^[\\s\\S][^<{]*/;\n    },\n};\n/**\n * 字符串转token\n *\n * @param {string} [str='']\n * @returns {TokenElement[]}\n */\nexport function getToken(str = '') {\n    const token = [];\n    let localStr = str;\n    let index = 0;\n    // closeStart\n    // 获取token，并记解析位置\n    function removePreSpace() {\n        const [space] = localStr.match(/^\\s+/) || [''];\n        index += space.length;\n        localStr = localStr.slice(space.length);\n    }\n    function getPrev(index) {\n        return token[token.length - index] || {};\n    }\n    function next() {\n        removePreSpace();\n        if (localStr.length == 0)\n            return;\n        // />\n        if (M.SELF_CLOSE.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.SELF_CLOSE) || ['', ''];\n            token.push(new TokenElement('SELF_CLOSE', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // </\n        if (M.CLOSE_START.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.CLOSE_START) || ['', ''];\n            token.push(new TokenElement('CLOSE_START', index, value));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // <\n        if (M.OPEN_START.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.OPEN_START) || ['', ''];\n            token.push(new TokenElement('OPEN_START', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // >\n        if (M.TAG_CLOSE.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.TAG_CLOSE) || ['', ''];\n            token.push(new TokenElement('TAG_CLOSE', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // =\n        if (M.EQ.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.EQ) || ['', ''];\n            token.push(new TokenElement('EQ', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // Aaa-bb 向前读一位需要是 OPEN_START | CLOSE_START\n        if (M.TAG_NAME.test(localStr)\n            && (getPrev(1).type == 'OPEN_START' || getPrev(1).type == 'CLOSE_START')) {\n            const [matchStr, value] = localStr.match(M.TAG_NAME) || ['', ''];\n            token.push(new TokenElement('TAG_NAME', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // :@Aaa-bb\n        if (M.PROPERTY_NAME.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.PROPERTY_NAME) || ['', ''];\n            token.push(new TokenElement('PROPERTY_NAME', index, value, matchStr));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n        // 属性value \"\" \n        if (M.PROPERTY_VALUE.test(localStr)\n            && getPrev(1).type == 'EQ' // 向前读一位需要是 EQ \n            && getPrev(2).type == 'PROPERTY_NAME' // 向前读2位需要是 PROPERTY_NAME\n        ) {\n            // 向前读，需要是\n            const [matchStr, value] = localStr.match(M.PROPERTY_VALUE) || ['', ''];\n            token.push(new TokenElement('PROPERTY_VALUE', index, value, matchStr));\n            index += matchStr.length;\n            localStr = localStr.slice(matchStr.length);\n            return next();\n        }\n        // 表达式\n        if (M.EXPR.test(localStr)) {\n            const [matchStr, value] = localStr.match(M.EXPR) || ['', ''];\n            token.push(new TokenElement('EXPR', index, value, matchStr));\n            index += matchStr.length;\n            localStr = localStr.slice(matchStr.length);\n            return next();\n        }\n        // 文本节点\n        if (M.STRING.test(localStr)) {\n            const [value] = localStr.match(M.STRING) || [''];\n            token.push(new TokenElement('STRING', index, value));\n            index += value.length;\n            localStr = localStr.slice(value.length);\n            return next();\n        }\n    }\n    next();\n    return token;\n}\n/**\n * 处理解析错误\n *\n * @param {any} token\n * @param {any} template\n * @param {any} message\n */\nfunction handleASTError(token, template, message) {\n    const str = template.slice(0, token.index);\n    const enter = str.match(/\\n/g);\n    const row = enter ? enter.length + 1 : 1;\n    const column = str.length - str.lastIndexOf('\\n');\n    console.error(`at row:${row} column:${column} \\n\\n${template.slice(token.index, token.index + 100)} \\n\\n${message}`);\n}\n// 读取元素 \n// token[0].type == 'OPEN_START'\n// token[1].type == 'TAG_NAME'\n// token[2].type == 'TAG_NAME' *\n//     token[3].type == 'EQ' && token[4].type == 'PROPERTY_VALUE'\n// token[0].type == 'TAG_CLOSE' || token[0].type == 'SELF_CLOSE'\n//     Element\n// token[0].type == 'CLOSE_START'\n// token[1].type == 'TAG_NAME'\n// token[2].type == 'TAG_CLOSE'\nexport function toAST(token = [], template = '') {\n    const root = new ASTNode();\n    let currentNode = root;\n    let index = 0;\n    let currentT;\n    const LEN = token.length;\n    function getT(index) {\n        return token[index] || {};\n    }\n    next();\n    function next() {\n        if (index >= LEN)\n            return;\n        // 当前token\n        currentT = token[index];\n        // open tag | close self tag\n        if (currentT.type == 'OPEN_START'\n            && getT(index + 1).type == 'TAG_NAME') {\n            // 获取\n            let localIndex = index + 2;\n            const props = {};\n            const tagName = getT(index + 1).value;\n            while (getT(localIndex).type == 'TAG_NAME' || getT(localIndex).type == 'PROPERTY_NAME') {\n                if (getT(localIndex + 1).type == 'EQ') {\n                    if (getT(localIndex + 2).type == 'PROPERTY_VALUE') {\n                        props[getT(localIndex).value] = getT(localIndex + 2).value;\n                        localIndex += 3;\n                        continue;\n                    }\n                    else {\n                        handleASTError(getT(localIndex), template, `${getT(localIndex).value} should have a value`);\n                    }\n                }\n                props[getT(localIndex).value] = true;\n                localIndex += 1;\n            }\n            const TAG_TYPE = getT(localIndex).type;\n            if (TAG_TYPE == 'TAG_CLOSE' || TAG_TYPE == 'SELF_CLOSE') {\n                const node = new ASTNode(tagName);\n                node.props = props;\n                node.parent = currentNode;\n                currentNode.children.push(node);\n                if (TAG_TYPE === 'TAG_CLOSE' && !selfCloseElements.includes(tagName)) {\n                    currentNode = node;\n                }\n            }\n            index = localIndex + 1;\n        }\n        else if (currentT.type == 'CLOSE_START'\n            && getT(index + 1).type == 'TAG_NAME'\n            && getT(index + 2).type == 'TAG_CLOSE') {\n            if (currentNode.tagName !== getT(index + 1).value) {\n                handleASTError(getT(index + 1), template, `close tag name should be ${currentNode.tagName}, but now is ${getT(index + 1).value}`);\n            }\n            currentNode = currentNode.parent;\n            index += 3;\n        }\n        else {\n            const last = currentNode.children[currentNode.children.length - 1];\n            if (currentT.type == 'EXPR') {\n                const node = new ASTNode();\n                node.value = currentT.value;\n                node.type = 'expr';\n                node.parent = currentNode;\n                currentNode.children.push(node);\n            }\n            else if (last && last.type === 'text') {\n                last.value += currentT.value;\n            }\n            else {\n                const node = new ASTNode();\n                node.type = 'text';\n                node.value = currentT.origin || currentT.value || '';\n                node.parent = currentNode;\n                currentNode.children.push(node);\n            }\n            index++;\n        }\n        next();\n    }\n    return root;\n}\nlet cache = {};\n// 字符串 => ast\nexport default function (template = '') {\n    // 使用缓存，不用再ast => dom的时候对ast进行修改\n    return cache[template] = cache[template] || toAST(getToken(template), template);\n}\n","let queue = [];\nlet timeout;\nexport function addExecQueue(list = []) {\n    // return list.forEach(fn => fn())\n    clearTimeout(timeout);\n    queue.push(...list);\n    timeout = setTimeout(forceUpdate);\n}\nexport default function forceUpdate(afterFn = () => { }) {\n    const haveExec = [];\n    queue.forEach(fn => {\n        if (!haveExec.includes(fn)) {\n            haveExec.push(fn);\n            fn();\n        }\n        else {\n            // console.log('不执行', fn.str)\n        }\n    });\n    window.time1 && console.log('执行结束: ', Date.now() - window.time1);\n    afterFn();\n}\n","import { getType, bindContext, uuid, isArray } from \"./util\";\nimport { addExecQueue } from \"./forceUpdate\";\nexport class Observe {\n}\nconst defaultCurrent = () => () => { };\n// observer数据get时，进行依赖手机\nlet currentFn = defaultCurrent;\n/**\n * 依赖\n * @class Depends\n */\nexport class Depends {\n    constructor(root, key) {\n        this.list = [];\n        this.root = root;\n        this.key = key;\n    }\n    collect() {\n        if (currentFn !== defaultCurrent) {\n            currentFn((fn) => {\n                // 获取依赖函数，并返回移除依赖函数\n                !this.list.includes(fn) && this.list.push(fn);\n                return () => {\n                    this.list = this.list.filter(i => i !== fn);\n                };\n            });\n        }\n    }\n    run() {\n        // debugger\n        // console.log(this.key, this.list)\n        addExecQueue(this.list);\n    }\n}\nclass ObserveId {\n    constructor() {\n        this.id = uuid() + ObserveId.id++;\n        this.keys = [];\n    }\n}\nObserveId.id = 0;\nfunction addObserverId(newObj) {\n    if (newObj.__observeId__ instanceof ObserveId) {\n        return;\n    }\n    Object.defineProperty(newObj, '__observeId__', {\n        value: new ObserveId(),\n        configurable: false,\n        writable: false,\n        enumerable: false,\n    });\n}\nexport function isObserve(obj) {\n    return (obj instanceof Observe) || (isArray(obj) && obj.__observe__);\n}\nexport function addObserve(ctx, key, defaultValue = ctx[key], options = { deep: false }) {\n    addObserverId(ctx);\n    // 这里隐含了一个bug，如果state,prop被更改，就懵逼了，因此设置state、props writable: false\n    if (ctx.__observeId__.keys.includes(key)) {\n        ctx[key] = defaultValue; // 数据已监听，则更新\n        return;\n    }\n    else {\n        ctx.__observeId__.keys.push(key);\n    }\n    let value = bindContext(defaultValue, ctx);\n    // 依赖此key的函数\n    const depends = new Depends(ctx, key);\n    let isResetValue = true;\n    // 默认bind this\n    Object.defineProperty(ctx, key, {\n        get() {\n            // 收集依赖\n            depends.collect();\n            // 只有在被获取的时候，才会对数据进行observe\n            if (isResetValue && options.deep) {\n                value = observer(value, Object.assign({}, options, { parentDepend: depends }));\n            }\n            isResetValue = false;\n            return value;\n        },\n        set(newValue) {\n            isResetValue = true;\n            value = bindContext(newValue, ctx);\n            // 触发依赖函数更新\n            depends.run();\n        },\n        enumerable: true,\n    });\n}\n/**\n * 监听数组\n * @param arr\n * @param parentDepends\n */\nexport function observeArr(arr = [], options) {\n    const newArr = arr.map(item => observer(item));\n    Object.defineProperty(newArr, '__observe__', {\n        value: true,\n        enumerable: false,\n        writable: false,\n        configurable: false,\n    });\n    [\n        'splice',\n        'push',\n        'shift',\n        'unshift',\n        'pop',\n    ].forEach(key => {\n        const value = [][key].bind(newArr);\n        // 如果数组长度被修改，通知他的父元节点\n        Object.defineProperty(newArr, key, {\n            get() {\n                return (...args) => {\n                    if (options.deep) {\n                        if (key == 'push' || key == 'unshift') {\n                            args = args.map(i => observer(i));\n                        }\n                        else if (key == 'splice') {\n                            args = args.slice(0, 2).concat(args.slice(2).map(i => observer(i)));\n                        }\n                    }\n                    const result = value(...args);\n                    // 对于数组的变化，直接出发调用数组的依赖\n                    console.log('arr change', key, options.parentDepend);\n                    options.parentDepend && options.parentDepend.run();\n                    // console.time('forceUpdate11')\n                    window.time1 = Date.now();\n                    return result;\n                };\n            },\n            enumerable: false,\n        });\n    });\n    return newArr;\n}\n/**\n * 监听对象\n * @param obj\n * @param init\n */\nexport function observeObj(obj = {}, options) {\n    let newObj = new Observe();\n    // 添加id\n    addObserverId(newObj);\n    Object.keys(obj).forEach(key => {\n        addObserve(newObj, key, obj[key], options);\n    });\n    return newObj;\n}\n/**\n * 构造一个新的observe对象\n * @param {objet} obj\n * @returns\n */\nexport function observer(obj, options = { deep: false }) {\n    if (isObserve(obj)) {\n        return obj;\n    }\n    switch (getType(obj)) {\n        case 'array':\n            return observeArr(obj, options);\n        case 'object':\n            return observeObj(obj, options);\n        default:\n            return obj;\n    }\n}\nexport function observerDeep(obj) {\n    return observer(obj, { deep: true });\n}\n/**\n * 接受函数，当依赖的数据发生变化后，会立即执行函数\n *\n * @param {function} fn\n * @returns\n */\nexport function autorun(fn, str, callback) {\n    let destoryDepends = [];\n    // 销毁依赖\n    const destory = () => {\n        destoryDepends.forEach(fn => fn());\n        destoryDepends = [];\n    };\n    const wrapFn = () => {\n        // console.log('autorun::', str, wrapFn.str, wrapFn.callback, wrapFn)\n        destory(); // 销毁上次依赖监听\n        // 收集本次依赖\n        currentFn = (getDestory) => {\n            destoryDepends.push(getDestory(wrapFn));\n            return wrapFn;\n        };\n        fn();\n        // 重置回默认值\n        currentFn = defaultCurrent;\n    };\n    wrapFn.str = str;\n    wrapFn.callback = callback;\n    // 立即执行\n    wrapFn();\n    return destory;\n}\n","import { uniqueArr } from \"./../util\";\nconst parseExpr = (() => {\n    const cache = {};\n    return function parseExpr(body) {\n        if (cache[body]) {\n            return cache[body];\n        }\n        // 去除字符串，剩下的都是变量\n        // 对于关键字new 和 对象的支持很懵逼\n        let params = (body.replace(/'[^']*'|\"[^\"]*\"/g, ' ') // 移除字符串\n            .replace(/([A-Za-z_$][A-Za-z0-9_$]*\\s*)?:/g, '') // 移除对象key\n            .match(/\\.?[A-Za-z_$][A-Za-z0-9_$]*/g) || [] // 获取所有变量 .?aa\n        ).filter(i => i[0] !== '.'); // 去除.aa\n        params = uniqueArr(params);\n        const result = {\n            params,\n            body,\n            fn: new Function(...params, `return ${body}`)\n        };\n        cache[body] = result;\n        return result;\n    };\n})();\nexport default parseExpr;\n","import { autorun } from \"./autorun\";\nimport { isArray } from './util';\nimport parseExpr from './parser/parseExpr';\nconst pipes = [];\nexport function addPipe(...ctxs) {\n    pipes.push(...ctxs);\n}\n/**\n * pipe 上一个函数返回结果作为下一个函数的输入\n * @param fns\n */\nfunction handlePipe(...fns) {\n    return (arg) => {\n        let result = arg;\n        fns.forEach(fn => {\n            result = fn(result);\n        });\n        return result;\n    };\n}\nfunction getPipes(exprs, ctxs) {\n    exprs = exprs.map(i => i.trim()).filter(i => i);\n    return handlePipe(...exprs.map(expr => execExprIm(expr, [...ctxs, ...pipes])));\n}\n// 分割表达式，只处理不重复的分隔符|\nconst parseFilter = (function () {\n    let parseFilterCache = {};\n    return function parseFilter(str = '') {\n        if (parseFilterCache[str]) {\n            return parseFilterCache[str];\n        }\n        const exprArr = [];\n        let current = '';\n        let index = 0;\n        while (index < str.length) {\n            const char = str[index];\n            if (char === '|'\n                && !/\\|\\s*$/.test(current)\n                && !/^\\s*\\|/.test(str.slice(index + 1))) {\n                exprArr.push(current);\n                current = '';\n            }\n            else {\n                current += char;\n            }\n            index += 1;\n        }\n        exprArr.push(current);\n        parseFilterCache[str] = exprArr;\n        return exprArr;\n    };\n}());\nfunction getValue(key, ctxs) {\n    for (let i = 0; i < ctxs.length; i++) {\n        if (ctxs[i][key] !== undefined) {\n            return ctxs[i][key];\n        }\n    }\n    return window[key];\n}\nexport function execExprIm(expr = '', ctxs) {\n    const splitResult = parseFilter(expr);\n    const inputExpr = splitResult[0];\n    // 我们不合并对象，因为对象可能是observable的，这里通过with嵌套的形式\n    const parseResult = parseExpr(expr);\n    const input = parseResult.fn(...parseResult.params.map(key => getValue(key, ctxs)));\n    // const names = ctxs.map((i, index) => '__with__local__' + index)\n    // let body = `return ${inputExpr}`\n    // names.reverse().forEach(i => {\n    //     body = `with (${i}) {\n    //         ${body}\n    //      }`\n    // })\n    // const input = new Function(...names, body)(...ctxs)\n    if (splitResult.length > 1) {\n        const pipes = getPipes(splitResult.slice(1), ctxs);\n        return handlePipe(pipes)(input);\n    }\n    return input;\n}\n/**\n * 执行表达式\n * @param {string} expr\n * @param {any[]} ctxs\n * @param {(result: any) => void} fn\n * @returns\n */\nexport function execExpr(expr, ctxs, fn) {\n    let oldValue;\n    let oldLen;\n    function isEqual(newValue, oldValue) {\n        // console.log(newValue, oldValue)\n        if (newValue !== oldValue) {\n            return false;\n        }\n        if (isArray(newValue)) {\n            const newLen = newValue.length;\n            const equal = newLen === oldLen;\n            oldLen = newLen;\n            return equal;\n        }\n        return true;\n    }\n    return fn && autorun(() => {\n        const newValue = execExprIm(expr, ctxs);\n        (!isEqual(newValue, oldValue)) && fn(newValue, oldValue);\n        oldValue = newValue;\n    }, expr, fn);\n}\n// 不应该在表达式内，定义一个observer\n","// 处理数组diff 返回数组变更\nimport { uniqueArr } from \"./util\";\nexport default function diff(oldArr = [], newArr = [], isKeyExist = true) {\n    newArr = uniqueArr(newArr);\n    // getDelete\n    let deleteArr = [];\n    let keepArr = [];\n    let deleteAll = false; // 是否删除所有元素\n    let addAll = false;\n    let prevIndex = -2;\n    let add;\n    if (!isKeyExist) {\n        return {\n            del: {\n                arr: oldArr,\n            },\n            add: {\n                before: {\n                    key: null,\n                    arr: newArr,\n                },\n                after: {\n                    key: null,\n                    arr: [],\n                }\n            }\n        };\n    }\n    for (let i = 0; i < oldArr.length; i++) {\n        const item = oldArr[i];\n        const INDEX = newArr.indexOf(item);\n        // console.log(INDEX, item)\n        if (INDEX < 0) {\n            deleteArr.push(item);\n        }\n        else {\n            // 判断是否在newArr中连续出现\n            if (prevIndex !== -2 && prevIndex + 1 !== INDEX) {\n                deleteAll = true;\n                addAll = true;\n                deleteArr = oldArr;\n                keepArr = [];\n                break;\n            }\n            else {\n                keepArr.push(item);\n            }\n            prevIndex = INDEX;\n        }\n    }\n    if (addAll || !keepArr.length) {\n        add = {\n            before: {\n                key: null,\n                arr: newArr,\n            },\n            after: {\n                key: 0,\n                arr: [],\n            }\n        };\n    }\n    else {\n        const start = newArr.indexOf(keepArr[0]);\n        const end = newArr.indexOf(keepArr[keepArr.length - 1]);\n        add = {\n            before: {\n                key: keepArr[0],\n                arr: newArr.slice(0, start)\n            },\n            after: {\n                key: keepArr[keepArr.length - 1],\n                arr: newArr.slice(end + 1)\n            },\n        };\n    }\n    // 计算新增数组\n    return {\n        del: {\n            arr: deleteArr,\n        },\n        add,\n    };\n}\n","import { execExpr } from \"./execExpr\";\nimport { toClassNames } from \"./util\";\nfunction updateClassName(element, classNames) {\n    element.className = Object.keys(classNames)\n        .map(key => classNames[key])\n        .map(i => i || '').join(' ').trim();\n}\nexport function testClass(vdom, type = '') {\n    const { ast, dom: element } = vdom;\n    type += (type ? '-' : '');\n    const classProperties = [\n        `@${type}class`,\n        `${type}class`,\n        `@${type}mclass`,\n        `${type}mclass`,\n    ];\n    return Object.keys(ast.props).some(key => classProperties.includes(key));\n}\n// class mclass\n// enter-class enter-mclass\n// leave-class leave-mclass\nexport default function handleClass(vdom, ctxs, key, type = '') {\n    const { ast: node, dom: element } = vdom;\n    const value = node.props[key];\n    const classNames = vdom.classNames = vdom.classNames || {};\n    type += (type ? '-' : '');\n    if (key === `:${type}class`) {\n        vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n            classNames[key] = toClassNames(newValue);\n            updateClassName(element, classNames);\n        }));\n    }\n    else if (key === `${type}class`) {\n        classNames[key] = value;\n        updateClassName(element, classNames);\n    }\n    else if (key === `:${type}mclass`) {\n        vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n            newValue = toClassNames(newValue).split(/\\s+/g).map(key => {\n                return (ctxs[0].mclass || {})[key];\n            }).join(' ');\n            classNames[key] = newValue;\n            updateClassName(element, classNames);\n        }));\n    }\n    else if (key === `${type}mclass`) {\n        classNames[key] = value.split(/\\s+/g).map(key => {\n            return (ctxs[0].mclass || {})[key];\n        }).join(' ');\n        updateClassName(element, classNames);\n    }\n    else {\n        return false;\n    }\n    return true;\n}\n","let isScroll = false;\nlet timeout;\nwindow.addEventListener('scroll', () => {\n    isScroll = true;\n    clearTimeout(timeout);\n    timeout = setTimeout(() => {\n        isScroll = false;\n    }, 50);\n});\n// 事件别名\nconst eventAlias = {\n    enter: (fn) => ([\n        {\n            eventName: 'keydown',\n            listener: (event, ...args) => {\n                if (event.keyCode == 13) {\n                    fn(event, ...args);\n                }\n            }\n        }\n    ]),\n    up: (fn) => ([\n        {\n            eventName: 'keydown',\n            listener: (event, ...args) => {\n                if (event.keyCode == 38) {\n                    fn(event, ...args);\n                }\n            }\n        }\n    ]),\n    down: (fn) => ([\n        {\n            eventName: 'keydown',\n            listener: (event, ...args) => {\n                if (event.keyCode == 40) {\n                    fn(event, ...args);\n                }\n            }\n        }\n    ]),\n    left: (fn) => ([\n        {\n            eventName: 'keydown',\n            listener: (event, ...args) => {\n                if (event.keyCode == 37) {\n                    fn(event, ...args);\n                }\n            }\n        }\n    ]),\n    esc: (fn) => ([\n        {\n            eventName: 'keyup',\n            listener: (event, ...args) => {\n                if (event.keyCode == 27) {\n                    fn(event, ...args);\n                }\n            }\n        }\n    ]),\n    ctrlEnter: (fn) => {\n        const recodeKey = {\n            ctrl: false,\n            enter: false,\n        };\n        return ([\n            {\n                eventName: 'keydown',\n                listener: (event, ...args) => {\n                    if (event.keyCode == 13) {\n                        recodeKey.enter = true;\n                    }\n                    else if (event.keyCode == 17) {\n                        recodeKey.ctrl = true;\n                    }\n                    recodeKey.enter && recodeKey.ctrl && fn(...args);\n                }\n            },\n            {\n                eventName: 'keyup',\n                listener: (event, ...args) => {\n                    if (event.keyCode == 13) {\n                        recodeKey.enter = false;\n                    }\n                    else if (event.keyCode == 17) {\n                        recodeKey.ctrl = false;\n                    }\n                }\n            }\n        ]);\n    },\n    click: (fn) => {\n        if (window.navigator.userAgent.toLowerCase().match(/android/) && 0) {\n            let time = 0;\n            let isMove = false;\n            return [\n                {\n                    eventName: 'touchstart',\n                    listener: (event) => {\n                        time = Date.now();\n                    }\n                },\n                {\n                    eventName: 'touchmove',\n                    listener: (event) => {\n                        isMove = true;\n                    }\n                },\n                {\n                    eventName: 'touchend',\n                    listener: (event) => {\n                        !isScroll && !isMove && (Date.now() - time < 200) && fn(event);\n                        isMove = false;\n                    }\n                },\n            ];\n        }\n        else {\n            return [{\n                    eventName: 'click',\n                    listener: fn\n                }];\n        }\n    }\n};\n/**\n * 添加事件别名\n * @param eventName\n * @param fn\n */\nexport function addEventAlias(eventName, fn) {\n    eventAlias[eventName] = fn;\n}\nexport function delEventAlias(eventName) {\n    delete eventAlias[eventName];\n}\nexport default eventAlias;\n","import handleClass, { testClass } from \"./handleClass\";\n/**\n * 判断dom是否可以异步卸载\n * @param vdom\n */\nexport function handleLeave(vdom) {\n    const { leaveTime } = vdom.ast.props;\n    if (vdom.dom && leaveTime && testClass(vdom, 'leave')) {\n        // vdom.dom.className += ` ${leaveClass}`\n        Object.keys(vdom.ast.props).forEach(key => {\n            handleClass(vdom, vdom.ctxs, key, 'leave');\n        });\n        setTimeout(() => {\n            vdom.dom && vdom.dom.parentElement && vdom.dom.parentElement.removeChild(vdom.dom);\n        }, +leaveTime);\n        return false;\n    }\n    return true;\n}\n/**\n * dom加载成功后，同步做某些事情\n * @param vdom\n */\nexport function handleEnter(vdom) {\n    if (vdom.dom && testClass(vdom, 'enter')) {\n        Object.keys(vdom.ast.props).forEach(key => {\n            handleClass(vdom, vdom.ctxs, key, 'enter');\n        });\n    }\n}\n","import { handleLeave } from \"./domLifeCycle\";\n// 因为AST与真实的dom之间还存在差距，因此我们在AST的基础之上，根据指令等其他条件又生成了一个真实DOM的映射树\n// 用来处理DOM的增删\n// 卸载元素/组件的时候，需要卸载相对应的事件/与数据监听\nexport function unmountNode(vdom, removeDOM = true) {\n    const _removeDOM = handleLeave(vdom);\n    vdom.children.forEach(i => unmountNode(i, removeDOM));\n    vdom.unmount();\n    // 如果vdom上有leave leaveTime\n    removeDOM && _removeDOM && vdom.dom && vdom.dom.parentElement && vdom.dom.parentElement.removeChild(vdom.dom);\n    if (vdom.parent) {\n        vdom.parent.children = vdom.parent.children.filter(i => i !== vdom);\n    }\n}\n/**\n * 卸载子元素\n * @param {any} ele\n */\nexport function unmountChildren(node) {\n    node.children.forEach(child => {\n        unmountNode(child);\n    });\n    node.children = [];\n}\n","import { getType, isString } from \"./util\";\nexport default function handleStyle(style) {\n    switch (getType(style)) {\n        case 'string': {\n            return style;\n        }\n        case 'array': {\n            return style.map(handleStyle).join(';');\n        }\n        case 'object': {\n            return Object.entries(style).map(([key, value]) => {\n                if (isString(value)) {\n                    const KEY = key.replace(/[A-Z]/g, $1 => '-' + $1.toLowerCase());\n                    return `${KEY}: ${value}`;\n                }\n                return '';\n            }).filter(i => i).join(';');\n        }\n        default: {\n            return '';\n        }\n    }\n}\n","import { VirtualDOM } from \"./d\";\nimport { observer, addObserve } from './autorun';\nimport { execExpr } from \"./execExpr\";\nimport { getType, isPromise, getComponent, getParentCtx, isFunction, isString } from './util';\nimport diff from './diff';\nimport render from './render';\nimport handleClass from \"./handleClass\";\nimport eventAlias from \"./eventAlias\";\nimport { unmountChildren, unmountNode } from \"./unmount\";\nimport handleStyle from \"./handleStyle\";\nimport { handleEnter } from \"./domLifeCycle\";\nfunction handleVFor(value, element, ctxs, vdom, node) {\n    const [itemIndex, arrName] = value.split(' in ').map(i => i.trim());\n    const [itemName, indexName] = itemIndex.replace(/(^\\s*\\()|(\\)\\s*$)/g, '').split(',').map(i => i.trim());\n    let isExeced = false; // 是否执行过\n    let cacheKeys = [];\n    let cacheKeyVdom = {};\n    vdom.exprs.push(execExpr(arrName, ctxs, (newValue, oldValue = []) => {\n        // console.log('数组发生变化', arrName, newValue.length, oldValue.length)\n        // v-for只应该含有一个子元素\n        if (node.children.length > 1) {\n            console.error(`v-for just should have one child`);\n        }\n        // diff cache key\n        const keyValue = node.children[0] && (node.children[0].props['key'] || node.children[0].props[':key']);\n        const newKeyValue = newValue.map((item, index) => {\n            let key;\n            execExpr(keyValue, [\n                ...ctxs,\n                {\n                    [itemName]: item,\n                    [indexName]: index,\n                }\n            ], (newValue, oldValue) => {\n                key = newValue;\n            })();\n            return {\n                key,\n                item,\n            };\n        });\n        const newKyes = newKeyValue.map(i => i.key);\n        const { add, del } = diff(cacheKeys, newKyes, keyValue);\n        // console.log('数组更新:', newValue, add, del)\n        if (isExeced) {\n            // 存在key，卸载需要删除的key对应的vdom，否则整体卸载\n            keyValue\n                ? del.arr.forEach(key => {\n                    unmountChildren(cacheKeyVdom[key].vdom);\n                    delete cacheKeyVdom[key]; // 删除缓存\n                })\n                : unmountChildren(vdom);\n        }\n        cacheKeys = newKyes;\n        isExeced = true;\n        // 我们只处理 移除 + 头尾新增的情况\n        // key不发生变化的需要更新index\n        // key新增的还是需要新增 \n        const childNode = element.childNodes && element.childNodes[0];\n        newKeyValue.forEach((keyItem, index) => {\n            const { key, item } = keyItem;\n            // 不存在就新增，存在就更新\n            if (!cacheKeyVdom[key]) {\n                const observeIndexItem = observer({\n                    [itemName]: item,\n                    [indexName]: index,\n                });\n                const PE = add.before.arr.includes(key) ? {\n                    appendChild: (newNode) => {\n                        childNode ? element.insertBefore(newNode, childNode) : element.appendChild(newNode);\n                        return newNode;\n                    }\n                } : element;\n                const result = transform(node, PE, [...ctxs, observeIndexItem], vdom);\n                // 如果没有key就不要加入缓存了\n                if (keyValue) {\n                    cacheKeyVdom[key] = {\n                        vdom: result,\n                        observeIndexItem,\n                    };\n                }\n            }\n            else {\n                cacheKeyVdom[key].observeIndexItem[indexName] = index;\n                cacheKeyVdom[key].observeIndexItem[itemName] = item;\n            }\n        });\n    }));\n}\n/**\n * 添加属性\n *\n * @param {HTMLElement} element\n * @param {any} node\n * @param {array} ctxs\n * @returns\n */\nfunction addProperties(element, vdom, ctxs) {\n    const { ast: node } = vdom;\n    const info = {\n        transformChildren: true,\n    };\n    Object.keys(node.props).forEach(key => {\n        const value = node.props[key];\n        // 处理class\n        if (handleClass(vdom, ctxs, key))\n            return;\n        // 处理事件绑定\n        if (key.startsWith('@')) {\n            const KEY = key.slice(1);\n            let aliasListeners = [];\n            vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n                if (eventAlias[KEY]) {\n                    // 使用事件别名\n                    aliasListeners.forEach(aliasListener => {\n                        vdom.events.off(element, aliasListener.eventName, aliasListener.listener);\n                    });\n                    aliasListeners = eventAlias[KEY](newValue);\n                    aliasListeners.forEach(aliasListener => {\n                        vdom.events.on(element, aliasListener.eventName, aliasListener.listener);\n                    });\n                }\n                else {\n                    vdom.events.off(element, KEY, oldValue);\n                    vdom.events.on(element, KEY, newValue);\n                }\n            }));\n        }\n        else if (key.startsWith(':')) {\n            vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n                const KEY = key.slice(1);\n                if (node.tagName == 'input' && KEY == 'checked') {\n                    element[KEY] = newValue;\n                    return;\n                }\n                if (KEY === 'style') {\n                    newValue = handleStyle(newValue);\n                }\n                element.setAttribute(KEY, newValue);\n            }));\n        }\n        else if (key.startsWith('v-')) {\n            // 显示\n            if (key === 'v-show') {\n                vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n                    element.style.cssText += `;display: ${newValue ? 'block' : 'none'};`;\n                }));\n            }\n            else if (key === 'v-for') {\n                info.transformChildren = false;\n                handleVFor(value, element, ctxs, vdom, node);\n            }\n        }\n        else if (key === 'ref') {\n            switch (getType(value)) {\n                case 'string': {\n                    ctxs[0].refs[value] = element;\n                    break;\n                }\n                case 'function': {\n                    value();\n                    break;\n                }\n            }\n        }\n        else {\n            element.setAttribute(key, node.props[key]);\n        }\n    });\n    return info;\n}\n/**\n * 处理v-if命令\n *\n * @param {HTMLElement} parent\n * @param {any} node\n * @param {array} ctxs\n */\nfunction handleVIf(parent, node, ctxs, parentVdom) {\n    let commentHook = document.createComment('v-if 占位');\n    parent.appendChild(commentHook);\n    let collect = [];\n    const destroy = parentVdom.exprs.push(execExpr(node.props['v-if'], ctxs, (newValue, oldValue) => {\n        if (newValue) {\n            addElement((ele, vdom) => {\n                vdom && collect.push(vdom);\n                ele && commentHook.parentElement && commentHook.parentElement.insertBefore(ele, commentHook);\n            }, node, ctxs, parentVdom);\n        }\n        else {\n            // 如果node\n            collect.forEach(i => unmountNode(i));\n            collect = [];\n        }\n    }));\n}\n/**\n * 获取自定义组件属性\n * @param node\n * @param vdom\n * @param ctxs\n */\nfunction getProps(vdom, ctxs) {\n    const { ast: node } = vdom;\n    let newProps = {};\n    Object.keys(node.props).forEach(key => {\n        const value = node.props[key];\n        if (/^[@:]/.test(key)) {\n            const KEY = key.slice(1);\n            vdom.exprs.push(execExpr(value, ctxs, (newValue, oldValue) => {\n                // 如果key为props，则对props进行rest操作，方便子组件对数据的获取\n                if (KEY === 'props') {\n                    Object.entries(newValue).forEach(([k, v]) => {\n                        addObserve(newProps, k, v);\n                    });\n                }\n                else {\n                    newProps[KEY] = newValue;\n                }\n            }));\n        }\n        else {\n            newProps[key] = value;\n        }\n    });\n    // 元素传递\n    newProps['children'] = {\n        node,\n        ctxs,\n    };\n    newProps = observer(newProps);\n    return newProps;\n}\nexport function isComponent(component, ast) {\n    if (isPromise(component) || isFunction(component) || isString(component)) {\n        return true;\n    }\n    console.error(component, `${ast.tagName} should be a Component!!! 您可以在组件的Components属性中添加子组件，或者通过Fv.register注册全局组件`);\n    return false;\n}\n/**\n * 添加元素\n *\n * @param {function} appendFn\n * @param {any} node\n * @param {array} ctxs\n * @returns\n */\nfunction addElement(appendFn, ast, ctxs, parentVdom) {\n    const vdom = new VirtualDOM(parentVdom);\n    vdom.ast = ast;\n    vdom.ctxs = ctxs;\n    if (/^[A-Z]/.test(ast.tagName)) {\n        // 处理子组件\n        const Com = getComponent(ast.tagName, ctxs);\n        // 判断是否是Component的子类\n        if (isComponent(Com, ast)) {\n            appendFn(undefined, vdom);\n            function renderComponent(Com) {\n                // 因为有可能是异步获取组件，因此这里对vdom进行判断，vdom是否已经被卸载\n                if (vdom.unmounted) {\n                    console.log('vdom已被卸载，不执行渲染');\n                    return;\n                }\n                // 通过创建一个Comment占位节点，可实无root渲染\n                const com = render(Com, getProps(vdom, ctxs), {\n                    appendChild: appendFn,\n                }, vdom);\n                com.parent = getParentCtx(ctxs);\n                com.parent.children.push(com);\n                vdom.component = com;\n                // 添加ref\n                if (ast.props.ref) {\n                    ctxs[0].refs[ast.props.ref] = com;\n                }\n            }\n            // 如果是Promise，可执行懒加载\n            if (isPromise(Com)) {\n                Com.then(Com => {\n                    renderComponent(Com);\n                });\n            }\n            else {\n                renderComponent(Com);\n            }\n        }\n    }\n    else if (ast.tagName == 'slot') {\n        // 处理slot，获取children后，并不监听变化\n        execExpr('props.children', ctxs, (newValue) => {\n            transform(newValue.node, {\n                appendChild: appendFn,\n            }, [getProps(vdom, ctxs), ...newValue.ctxs], parentVdom);\n        })();\n    }\n    else {\n        let createE = document.createElement(ast.tagName);\n        vdom.dom = createE;\n        appendFn(createE, vdom);\n        const result = addProperties(createE, vdom, ctxs);\n        handleEnter(vdom); // 处理enter-class\n        result.transformChildren && ast.children && ast.children.length && transform(ast, createE, ctxs, vdom);\n    }\n    return vdom;\n}\n// \n/**\n * ast transform to node\n *\n * @param {any} ast\n * @param {HTMLElement} element\n * @param {anray} ctxs\n */\nfunction transform(ast, element, ctxs, parentVdom = new VirtualDOM()) {\n    const vdoms = ast.children.map(node => {\n        if (node.type === 'element' || node.type === 'component') {\n            // 处理v-if指令\n            if (node.props['v-if']) {\n                handleVIf(element, node, ctxs, parentVdom);\n            }\n            else {\n                return addElement((createE) => {\n                    createE && element.appendChild(createE);\n                }, node, ctxs, parentVdom);\n            }\n        }\n        else {\n            const vdom = new VirtualDOM(parentVdom);\n            vdom.ast = ast;\n            vdom.ctxs = ctxs;\n            let createE;\n            if (node.type === 'expr') {\n                createE = document.createTextNode('');\n                element.appendChild(createE);\n                vdom.exprs.push(execExpr(node.value, ctxs, (newValue) => {\n                    createE.textContent = newValue;\n                }));\n            }\n            else {\n                createE = document.createTextNode(node.value);\n                element.appendChild(createE);\n            }\n            vdom.dom = createE;\n            parentVdom.children.push(vdom);\n            return vdom;\n        }\n    }).filter(i => i);\n    return {\n        children: vdoms\n    };\n}\nexport default transform;\n","import Component from './Component';\nimport toAST from './ast';\nimport transform from './transform';\nimport { observer, addObserve, autorun } from './autorun';\nimport { merge, isFunction, isString } from \"./util\";\n/**\n * @param {any} Com\n * @param {*} props\n * @param {HTMLElement} dom\n * @returns {Component}\n */\nexport default function render(Com, props, dom, vdom) {\n    if (isFunction(Com)) {\n        // 如果函数没有继承Component，就把它当做render方法\n        if (!(Com.prototype instanceof Component)) {\n            const renderFn = Com;\n            Com = class extends Component {\n                constructor() {\n                    super(...arguments);\n                    this.render = renderFn;\n                }\n            };\n        }\n    }\n    else if (isString(Com)) {\n        const template = Com;\n        Com = class extends Component {\n            constructor() {\n                super(...arguments);\n                this.template = template;\n            }\n        };\n    }\n    else {\n        console.error(`render first param should be a function`);\n    }\n    const ctx = new Com();\n    // state 与 props 属性不可被更改\n    Object.defineProperty(ctx, 'state', {\n        writable: false,\n        enumerable: true,\n        value: observer(ctx.state, { deep: true }),\n    });\n    Object.defineProperty(ctx, 'props', {\n        writable: false,\n        enumerable: true,\n        value: observer(merge(props, Com.defaultProps || {})),\n    });\n    // 处理需要有个autorun包裹，然后\n    // 需要obersev\n    Object.keys(ctx.computed).forEach(key => {\n        addObserve(ctx, key, ctx.computed[key].call(ctx));\n        // 待收集依赖\n        autorun(() => {\n            ctx[key] = ctx.computed[key].call(ctx);\n        });\n    });\n    ctx.willMount();\n    const ast = toAST(ctx.render());\n    ast.ctx = ctx;\n    transform(ast, dom, [ctx, ctx.state, ctx.props], vdom);\n    ctx.didMount();\n    return ctx;\n}\n","import Component from './Component';\nimport render from './render';\nimport { autorun, observer, isObserve, addObserve, observerDeep } from './autorun';\nimport register, { registerComponents } from \"./register\";\nimport { addEventAlias } from \"./eventAlias\";\nimport { addPipe } from \"./execExpr\";\nimport forceUpdate from \"./forceUpdate\";\nexport default {\n    Component,\n    render,\n    autorun,\n    observer,\n    isObserve,\n    addObserve,\n    observerDeep,\n    register,\n    addEventAlias,\n    registerComponents,\n    addPipe,\n    forceUpdate,\n};\nexport { Component, render, autorun, observer, isObserve, addObserve, observerDeep, register, addEventAlias, registerComponents, addPipe, forceUpdate, };\n"],"names":["registerComponents","register","name","Com","getType","arg","Object","prototype","toString","call","match","toLowerCase","isFunction","args","every","isArray","isString","isPromise","toClassNames","v","map","join","keys","key","uniqueArr","arr","newArr","forEach","includes","item","push","merge","anys","base","slice","any","bindContext","fn","ctx","bind","uuid","len","S","LEN","length","repeat","split","Math","round","random","getComponent","ctxs","i","components","getParentCtx","Component","template","state","props","children","refs","computed","$emit","data","parent","stopBubble","emit","$emitChildren","node","$emitSiblings","com","__willUnmount","willUnmount","filter","defaultProps","FVEvents","cache","element","addEventListener","_key","_fn","undefined","removeEventListener","VirtualDOM","exprs","events","unmounted","dom","HTMLElement","off","component","TokenElement","type","index","value","origin","ASTNode","tagName","test","selfCloseElements","M","SELF_CLOSE","CLOSE_START","TAG_CLOSE","OPEN_START","EQ","TAG_NAME","PROPERTY_NAME","PROPERTY_VALUE","EXPR","STRING","getToken","str","token","localStr","removePreSpace","space","getPrev","next","matchStr","handleASTError","message","enter","row","column","lastIndexOf","error","toAST","root","currentNode","currentT","getT","localIndex","TAG_TYPE","last","queue","timeout","addExecQueue","list","setTimeout","forceUpdate","afterFn","haveExec","time1","console","log","Date","now","window","Observe","defaultCurrent","currentFn","Depends","ObserveId","id","addObserverId","newObj","__observeId__","defineProperty","isObserve","obj","__observe__","addObserve","defaultValue","options","deep","depends","isResetValue","collect","observer","assign","parentDepend","newValue","run","observeArr","concat","result","observeObj","observerDeep","autorun","callback","destoryDepends","destory","wrapFn","getDestory","parseExpr","body","params","replace","Function","pipes","addPipe","handlePipe","fns","getPipes","trim","execExprIm","expr","parseFilter","parseFilterCache","exprArr","current","char","getValue","splitResult","inputExpr","parseResult","input","execExpr","oldValue","oldLen","isEqual","newLen","equal","diff","oldArr","isKeyExist","deleteArr","keepArr","addAll","prevIndex","add","INDEX","indexOf","start","end","updateClassName","classNames","className","testClass","vdom","ast","classProperties","some","handleClass","mclass","isScroll","eventAlias","event","keyCode","recodeKey","ctrl","navigator","userAgent","time","isMove","addEventAlias","eventName","handleLeave","leaveTime","parentElement","removeChild","handleEnter","unmountNode","removeDOM","_removeDOM","unmount","unmountChildren","child","handleStyle","style","entries","KEY","$1","handleVFor","itemIndex","arrName","itemName","indexName","isExeced","cacheKeys","cacheKeyVdom","keyValue","newKeyValue","newKyes","del","childNode","childNodes","keyItem","observeIndexItem","PE","before","newNode","insertBefore","appendChild","transform","addProperties","info","startsWith","aliasListeners","aliasListener","listener","on","setAttribute","cssText","transformChildren","handleVIf","parentVdom","commentHook","document","createComment","destroy","ele","getProps","newProps","k","isComponent","addElement","appendFn","renderComponent","render","ref","then","createE","createElement","vdoms","createTextNode","textContent","renderFn","arguments","willMount","didMount"],"mappings":"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"}